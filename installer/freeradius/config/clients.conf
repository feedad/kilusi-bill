# ===========================================
# FreeRADIUS Clients Configuration
# ===========================================
# This file defines which RADIUS clients are allowed to connect
# to this FreeRADIUS server.
#
# Format:
# client <shortname> {
#     ipaddr          = <IP address or network>
#     ipv6addr        = <IPv6 address or network>
#     netmask         = <netmask>
#     secret          = <shared secret>
#     shortname       = <short name for logging>
#     nas_type        = <type of NAS>
#     login           = <login for restricted access>
#     password        = <password for restricted access>
#     virtual_server  = <virtual server to use>
# }
# ===========================================

# Localhost client (for testing)
client localhost {
    ipaddr = 127.0.0.1
    secret = testing123
    shortname = localhost
    nastype = other
}

# IPv6 localhost
client localhost_ipv6 {
    ipv6addr = ::1
    secret = testing123
    shortname = localhost_ipv6
    nastype = other
}

# Allow connections from any host in the Docker network
# Useful for containers in the same Docker network
client docker-network {
    ipaddr = 172.16.0.0/12
    secret = testing123
    shortname = docker-net
    nastype = other
}

# Allow connections from private networks
# This allows any device in private IP ranges to connect
# WARNING: Only use this in secure environments!
client private-network-10 {
    ipaddr = 10.0.0.0/8
    secret = testing123
    shortname = private-10
    nastype = other
}

client private-network-172 {
    ipaddr = 172.16.0.0/12
    secret = testing123
    shortname = private-172
    nastype = other
}

client private-network-192 {
    ipaddr = 192.168.0.0/16
    secret = testing123
    shortname = private-192
    nastype = other
}

# ===========================================
# Specific NAS/Router Configurations
# ===========================================

# Mikrotik Router 1 - Main Router
client mikrotik-main {
    ipaddr = 192.168.88.1
    secret = testing123
    shortname = mikrotik-1
    nastype = other
    description = "Main Mikrotik Router"
}

# Mikrotik Router 2 - Backup Router
client mikrotik-backup {
    ipaddr = 192.168.88.2
    secret = testing123
    shortname = mikrotik-2
    nastype = other
    description = "Backup Mikrotik Router"
}

# Mikrotik Router 3 - POP Site
client mikrotik-pop {
    ipaddr = 192.168.89.1
    secret = testing123
    shortname = mikrotik-pop
    nastype = other
    description = "Mikrotik at POP Site"
}

# Cisco Router/Accelerator
client cisco-router {
    ipaddr = 192.168.1.1
    secret = cisco-secret
    shortname = cisco-01
    nastype = cisco
    description = "Cisco Router"
}

# Ubiquiti EdgeRouter
client edgerouter {
    ipaddr = 192.168.1.254
    secret = ubnt-secret
    shortname = edge-01
    nastype = other
    description = "Ubiquiti EdgeRouter"
}

# Ubiquiti Access Points
client ubiquiti-aps {
    ipaddr = 192.168.2.0/24
    secret = ubnt-secret
    shortname = ubnt-aps
    nastype = other
    description = "Ubiquiti Access Points Network"
}

# ===========================================
# Wireless Controllers
# ===========================================

# Aruba Wireless Controller
client aruba-wlc {
    ipaddr = 192.168.10.10
    secret = aruba-secret
    shortname = aruba-wlc
    nastype = aruba
    description = "Aruba Wireless Controller"
}

# Ruckus Wireless Controller
client ruckus-zd {
    ipaddr = 192.168.10.20
    secret = ruckus-secret
    shortname = ruckus-zd
    nastype = other
    description = "Ruckus ZoneDirector"
}

# Ubiquiti UniFi Controller
client unifi-controller {
    ipaddr = 192.168.10.30
    secret = unifi-secret
    shortname = unifi-ctlr
    nastype = other
    description = "UniFi Controller"
}

# ===========================================
# VPN Servers
# ===========================================

# OpenVPN Access Server
client openvpn-server {
    ipaddr = 192.168.100.1
    secret = vpn-secret
    shortname = openvpn-01
    nastype = other
    description = "OpenVPN Access Server"
}

# ===========================================
# PPPoE Servers
# ===========================================

# PPPoE Server 1
client pppoe-server-1 {
    ipaddr = 192.168.200.1
    secret = pppoe-secret
    shortname = pppoe-1
    nastype = other
    description = "PPPoE Server 1"
}

# PPPoE Server 2
client pppoe-server-2 {
    ipaddr = 192.168.200.2
    secret = pppoe-secret
    shortname = pppoe-2
    nastype = other
    description = "PPPoE Server 2"
}

# ===========================================
# Testing Clients
# ===========================================

# Test NAS for debugging
client test-nas {
    ipaddr = 192.168.254.254
    secret = test-secret
    shortname = test-nas
    nastype = other
    description = "Test NAS for debugging"
}

# ===========================================
# Client Groups (for multiple devices with same config)
# ===========================================

# Group of Mikrotik devices
# Each Mikrotik router can be added here
# They will use the same secret and configuration

# Mikrotik routers in different locations
client mikrotik-location-1 {
    ipaddr = 10.0.1.1
    secret = mikrotik-loc1-secret
    shortname = mk-loc1
    nastype = other
    description = "Mikrotik Location 1"
}

client mikrotik-location-2 {
    ipaddr = 10.0.2.1
    secret = mikrotik-loc2-secret
    shortname = mk-loc2
    nastype = other
    description = "Mikrotik Location 2"
}

client mikrotik-location-3 {
    ipaddr = 10.0.3.1
    secret = mikrotik-loc3-secret
    shortname = mk-loc3
    nastype = other
    description = "Mikrotik Location 3"
}

# ===========================================
# Advanced Client Configuration
# ===========================================

# Example client with specific virtual server
# client advanced-example {
#     ipaddr = 192.168.50.1
#     secret = advanced-secret
#     shortname = advanced
#     nastype = other
#     virtual_server = my_virtual_server
#     require_message_authenticator = yes
#     coa_server = coa
# }

# Example client with restricted access
# client restricted {
#     ipaddr = 192.168.60.1
#     secret = restricted-secret
#     shortname = restricted
#     nastype = other
#     login = restricted_user
#     password = restricted_pass
# }

# ===========================================
# Dynamic Client Configuration
# ===========================================
# Clients can also be read from the database
# See raddb/mods-available/sql for configuration
# When read_clients = yes, FreeRADIUS will read
# client definitions from the 'nas' table

# The database table 'nas' should contain:
# - nasname: IP address or hostname
# - shortname: Short name
# - type: Type of NAS
# - secret: Shared secret
# - server: Virtual server to use
# - ports: Number of ports
# - community: SNMP community string

# ===========================================
# Security Notes
# ===========================================
# 1. Always use strong secrets in production
# 2. Use specific IP addresses instead of networks when possible
# 3. Limit client access to specific subnets
# 4. Rotate secrets periodically
# 5. Monitor authentication logs for unauthorized access attempts
# 6. Use firewall rules to restrict RADIUS port access
# 7. Consider using CoA (Change of Authorization) for dynamic control

# ===========================================
# IPv6 Clients
# ===========================================
# Example IPv6 client configuration
# client ipv6-example {
#     ipv6addr = 2001:db8::1
#     secret = ipv6-secret
#     shortname = ipv6-client
#     nastype = other
# }

# IPv6 network client
# client ipv6-network {
#     ipv6addr = 2001:db8:1::/64
#     secret = ipv6-net-secret
#     shortname = ipv6-net
#     nastype = other
# }